"0","# SIR model function "
"0",""
"0","sir_model2 <- function(time,state,parameters){"
"0","  with(as.list(c(state,parameters)),{"
"0","    N=S+I+R"
"0","    dS=-alpha*S*(I/N)"
"0","    dI= alpha*S*(I/N)-beta*I"
"0","    dR= beta*I"
"0","    "
"0","    return(list(c(dS,dI,dR)))"
"0","  }"
"0","  )"
"0","}"
"0",""
"0","#Solving the differential equations"
"0","output2<-as.data.frame(ode(y=initial_state_values,func = sir_model2,parms=parameters,times = time))%>%"
"0","  mutate(S = format(S, scientific = F, digits = 1))%>%"
"0","  mutate(I = format(I, scientific = F, digits = 1))%>%"
"0","  mutate(R = format(R, scientific = F, digits = 1))%>%"
"0","  mutate(across(c(2:4), as.numeric))"
"0",""
"0","out_long2 <- melt(output2,id=""time"")"
"0","# To plot the proportion of susceptible, infected and recovered individuals over time"
"0","ggplot(data = out_long2,          "
"0","       aes(x = time, "
"0","           y = value/S_I_R_V2$population[S_I_R_V2$x2020 == ""Total""], colour = variable)) +  "
"0","  geom_line() +"
"0","  #scale_x_continuous(n.breaks = 20)+"
"0","  scale_x_continuous(breaks = seq(0, length(seq(as.Date(""2020/03/13""), as.Date(""2021/08/31""), by=1)), by = 30))+"
"0","    scale_y_continuous(n.breaks = 10)+"
"0","  xlab(""Time (days)"")+"
"0","  ylab(""Proportion of the population"")+"
"0","  scale_color_discrete(name=""State"")"
"0",""
